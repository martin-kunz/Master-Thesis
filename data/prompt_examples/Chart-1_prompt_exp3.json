[
  {
    "role": "system",
    "content": "You are an assistant for augmenting the test suite in our Java software. You write a JUnit test case that reproduce the failure behavior of the bug report."
  },
  {
    "role": "user",
    "content": "Generate a self-contained reproducing test case from the following bug report.\n\n\n# #983 Potential NPE in AbstractCategoryItemRender.getLegendItems()\n\n\n\n\n## Description\nSetting up a working copy of the current JFreeChart trunk in Eclipse I got a warning about a null pointer access in this bit of code from AbstractCategoryItemRender.java:\n\n\npublic LegendItemCollection getLegendItems() {  \n\nLegendItemCollection result = new LegendItemCollection();  \n\nif (this.plot == null) {  \n\nreturn result;  \n\n}  \n\nint index = this.plot.getIndexOf(this);  \n\nCategoryDataset dataset = this.plot.getDataset(index);  \n\nif (dataset != null) {  \n\nreturn result;  \n\n}  \n\nint seriesCount = dataset.getRowCount();  \n\n...  \n\n}\n\n\nThe warning is in the last code line where seriesCount is assigned. The variable dataset is guaranteed to be null in this location, I suppose that the check before that should actually read \"if (dataset == null)\", not \"if (dataset != null)\".\n\n\nThis is trunk as of 2010-02-08.\n\n\n\n---\n\nTo help you, here is some relevant API documentation for the project 'Chart':\n---\n# Library Docs Bundle for Chart_1\n## org.jfree.chart.ChartColor\n> Class to extend the number of Colors available to the charts. This\n> extends the java.awt.Color object and extends the number of final\n> Colors publically accessible.\n> A very dark red color.\n> A dark red color.\n> A light red color.\n> A very light red color.\n> A very dark yellow color.\n> A dark yellow color.\n> A light yellow color.\n> A very light yellow color.\n> A very dark green color.\n> A dark green color.\n> A light green color.\n> A very light green color.\n> A very dark cyan color.\n> A dark cyan color.\n## org.jfree.chart.ChartFactory\n> A collection of utility methods for creating some standard charts with\n> JFreeChart.\n> The chart theme.\n> Returns the current chart theme used by the factory.\n> @return The chart theme.\n> @see #setChartTheme(ChartTheme)\n> @see ChartUtilities#applyCurrentTheme(JFreeChart)\n> @since 1.0.11\n> Sets the current chart theme.  This will be applied to all new charts\n> created via methods in this class.\n> @param theme  the theme (<code>null</code> not permitted).\n> @see #getChartTheme()\n> @see ChartUtilities#applyCurrentTheme(JFreeChart)\n> @since 1.0.11\n> Creates a pie chart with default settings.  The chart object returned\n> by this method uses a {@link PiePlot} instance as the plot.\n> @param title  the chart title (<code>null</code> permitted).\n> @param dataset  the dataset for the chart (<code>null</code> permitted).\n> @param legend  a flag specifying whether or not a legend is required.\n> @return A pie chart.\n> Creates a pie chart with default settings.\n> <P>\n> The chart object returned by this method uses a {@link PiePlot} instance\n> as the plot.\n> @param title  the chart title (<code>null</code> permitted).\n> @param dataset  the dataset for the chart (<code>null</code> permitted).\n> @param legend  a flag specifying whether or not a legend is required.\n> @param locale  the locale (<code>null</code> not permitted).\n> @return A pie chart.\n> @since 1.0.7\n> Creates a pie chart with default settings that compares 2 datasets.\n> The colour of each section will be determined by the move from the value\n> for the same key in <code>previousDataset</code>. ie if value1 > value2\n> then the section will be in green (unless <code>greenForIncrease</code>\n> is <code>false</code>, in which case it would be <code>red</code>).\n> Each section can have a shade of red or green as the difference can be\n> tailored between 0% (black) and percentDiffForMaxScale% (bright\n> red/green).\n> <p>\n> For instance if <code>percentDiffForMaxScale</code> is 10 (10%), a\n> difference of 5% will have a half shade of red/green, a difference of\n> 10% or more will have a maximum shade/brightness of red/green.\n> <P>\n> The chart object returned by this method uses a {@link PiePlot} instance\n> as the plot.\n> <p>\n> Written by <a href=\"mailto:opensource@objectlab.co.uk\">Benoit\n> Xhenseval</a>.\n> @param title  the chart title (<code>null</code> permitted).\n> @param dataset  the dataset for the chart (<code>null</code> permitted).\n> @param previousDataset  the dataset for the last run, this will be used\n>                         to compare each key in the dataset\n> @param percentDiffForMaxScale scale goes from bright red/green to black,\n>                               percentDiffForMaxScale indicate the change\n>                               required to reach top scale.\n> @param greenForIncrease  an increase since previousDataset will be\n>                          displayed in green (decrease red) if true.\n> @param legend  a flag specifying whether or not a legend is required.\n> @param locale  the locale (<code>null</code> not permitted).\n> @param subTitle displays a subtitle with colour scheme if true\n> @param showDifference  create a new dataset that will show the %\n>                        difference between the two datasets.\n> @return A pie chart.\n> @since 1.0.7\n> Creates a pie chart with default settings that compares 2 datasets.\n> The colour of each section will be determined by the move from the value\n> for the same key in <code>previousDataset</code>. ie if value1 > value2\n> then the section will be in green (unless <code>greenForIncrease</code>\n> is <code>false</code>, in which case it would be <code>red</code>).\n> Each section can have a shade of red or green as the difference can be\n> tailored between 0% (black) and percentDiffForMaxScale% (bright\n> red/green).\n> <p>\n> For instance if <code>percentDiffForMaxScale</code> is 10 (10%), a\n> difference of 5% will have a half shade of red/green, a difference of\n> 10% or more will have a maximum shade/brightness of red/green.\n> <P>\n> The chart object returned by this method uses a {@link PiePlot} instance\n> as the plot.\n> <p>\n> Written by <a href=\"mailto:opensource@objectlab.co.uk\">Benoit\n> Xhenseval</a>.\n> @param title  the chart title (<code>null</code> permitted).\n> @param dataset  the dataset for the chart (<code>null</code> permitted).\n> @param previousDataset  the dataset for the last run, this will be used\n>                         to compare each key in the dataset\n> @param percentDiffForMaxScale scale goes from bright red/green to black,\n>                               percentDiffForMaxScale indicate the change\n>                               required to reach top scale.\n> @param greenForIncrease  an increase since previousDataset will be\n>                          displayed in green (decrease red) if true.\n> @param legend  a flag specifying whether or not a legend is required.\n> @param subTitle displays a subtitle with colour scheme if true\n> @param showDifference  create a new dataset that will show the %\n>                        difference between the two datasets.\n> @return A pie chart.\n> Creates a ring chart with default settings. The chart object returned by\n> this method uses a {@link RingPlot} instance as the plot.\n> @param title  the chart title (<code>null</code> permitted).\n> @param dataset  the dataset for the chart (<code>null</code> permitted).\n> @param legend  a flag specifying whether or not a legend is required.\n> @return A ring chart.\n> Creates a ring chart with default settings.\n> <P>\n> The chart object returned by this method uses a {@link RingPlot}\n> instance as the plot.\n> @param title  the chart title (<code>null</code> permitted).\n> @param dataset  the dataset for the chart (<code>null</code> permitted).\n> @param legend  a flag specifying whether or not a legend is required.\n> @param locale  the locale (<code>null</code> not permitted).\n> @return A ring chart.\n> @since 1.0.7\n> Creates a chart that displays multiple pie plots.  The chart object\n> returned by this method uses a {@link MultiplePiePlot} instance as the\n> plot.\n> @param title  the chart title (<code>null</code> permitted).\n> @param dataset  the dataset (<code>null</code> permitted).\n> @param order  the order that the data is extracted (by row or by column)\n>               (<code>null</code> not permitted).\n> @param legend  include a legend?\n> @return A chart.\n> Creates a 3D pie chart using the specified dataset.  The chart object\n> returned by this method uses a {@link PiePlot3D} instance as the\n> plot.\n> @param title  the chart title (<code>null</code> permitted).\n> @param dataset  the dataset for the chart (<code>null</code> permitted).\n> @param legend  a flag specifying whether or not a legend is required.\n> @param locale  the locale (<code>null</code> not permitted).\n> @return A pie chart.\n> @since 1.0.7\n> Creates a 3D pie chart using the specified dataset.  The chart object\n> returned by this method uses a {@link PiePlot3D} instance as the\n> plot.\n> @param title  the chart title (<code>null</code> permitted).\n> @param dataset  the dataset for the chart (<code>null</code> permitted).\n> @param legend  a flag specifying whether or not a legend is required.\n> @return A pie chart.\n> Creates a chart that displays multiple pie plots.  The chart object\n> returned by this method uses a {@link MultiplePiePlot} instance as the\n> plot.\n> @param title  the chart title (<code>null</code> permitted).\n> @param dataset  the dataset (<code>null</code> permitted).\n> @param order  the order that the data is extracted (by row or by column)\n>               (<code>null</code> not permitted).\n> @param legend  include a legend?\n> @return A chart.\n> Creates a bar chart.  The chart object returned by this method uses a\n> {@link CategoryPlot} instance as the plot, with a {@link CategoryAxis}\n> for the domain axis, a {@link NumberAxis} as the range axis, and a\n> {@link BarRenderer} as the renderer.\n> @param title  the chart title (<code>null</code> permitted).\n> @param categoryAxisLabel  the label for the category axis\n>                           (<code>null</code> permitted).\n> @param valueAxisLabel  the label for the value axis\n>                        (<code>null</code> permitted).\n> @param dataset  the dataset for the chart (<code>null</code> permitted).\n> @param legend  a flag specifying whether or not a legend is required.\n> @return A bar chart.\n## org.jfree.chart.ChartPanel\n> A Swing GUI component for displaying a {@link JFreeChart} object.\n> <P>\n> The panel registers with the chart to receive notification of changes to any\n> component of the chart.  The chart is redrawn automatically whenever this\n> notification is received.\n> For serialization.\n> Default setting for buffer usage.  The default has been changed to\n> <code>true</code> from version 1.0.13 onwards, because of a severe\n> performance problem with drawing the zoom rectangle using XOR (which\n> now happens only when the buffer is NOT used).\n> The default panel width.\n> The default panel height.\n> The default limit below which chart scaling kicks in.\n> The default limit below which chart scaling kicks in.\n> The default limit above which chart scaling kicks in.\n> The default limit above which chart scaling kicks in.\n> The minimum size required to perform a zoom on a rectangle\n> Properties action command.\n> Copy action command.\n> @since 1.0.13\n> Save action command.\n> Print action command.\n> Zoom in (both axes) action command.\n## org.jfree.chart.ChartRenderingInfo\n> A structure for storing rendering information from one call to the\n> JFreeChart.draw() method.\n> <P>\n> An instance of the {@link JFreeChart} class can draw itself within an\n> arbitrary rectangle on any <code>Graphics2D</code>.  It is assumed that\n> client code will sometimes render the same chart in more than one view, so\n> the {@link JFreeChart} instance does not retain any information about its\n> rendered dimensions.  This information can be useful sometimes, so you have\n> the option to collect the information at each call to\n> <code>JFreeChart.draw()</code>, by passing an instance of this\n> <code>ChartRenderingInfo</code> class.\n> For serialization.\n> The area in which the chart is drawn.\n> Rendering info for the chart's plot (and subplots, if any).\n> Storage for the chart entities.  Since retaining entity information for\n> charts with a large number of data points consumes a lot of memory, it\n> is intended that you can set this to <code>null</code> to prevent the\n> information being collected.\n> The rendering source.  This is the object that calls the draw(...)\n> method in the {@link JFreeChart} class, or <code>null</code> if the\n> rendering source chooses to remain anonymous.  Our initial use for\n> this is to identify the {@link ChartPanel} that is drawing a chart, so\n> that selection state info can be retrieved from the panel in some\n> cases.\n> @since 1.2.0\n> Constructs a new ChartRenderingInfo structure that can be used to\n> collect information about the dimensions of a rendered chart.\n> Constructs a new instance. If an entity collection is supplied, it will\n> be populated with information about the entities in a chart.  If it is\n> <code>null</code>, no entity information (including tool tips) will\n> be collected.\n> @param entities  an entity collection (<code>null</code> permitted).\n> Returns the area in which the chart was drawn.\n> @return The area in which the chart was drawn.\n> @see #setChartArea(Rectangle2D)\n> Sets the area in which the chart was drawn.\n> @param area  the chart area.\n> @see #getChartArea()\n> Returns the collection of entities maintained by this instance.\n> @return The entity collection (possibly <code>null</code>).\n> @see #setEntityCollection(EntityCollection)\n> Sets the entity collection.\n> @param entities  the entity collection (<code>null</code> permitted).\n> @see #getEntityCollection()\n> Returns the rendering source, or <code>null</code>.\n> @return The rendering source (possibly <code>null</code>).\n> @see #setRenderingSource(org.jfree.chart.RenderingSource)\n> @since 1.2.0\n> Sets the rendering source.\n> @param source  the source (<code>null</code> permitted).\n> @see #getRenderingSource()\n> @since 1.2.0\n> Clears the information recorded by this object, but not the\n> rendering source.\n## org.jfree.chart.ChartUtilities\n> A collection of utility methods for JFreeChart.  Includes methods for\n> converting charts to image formats (PNG and JPEG) plus creating simple HTML\n> image maps.\n> @see ImageMapUtilities\n> Applies the current theme to the specified chart.  This method is\n> provided for convenience, the theme itself is stored in the\n> {@link ChartFactory} class.\n> @param chart  the chart (<code>null</code> not permitted).\n> @since 1.0.11\n> Writes a chart to an output stream in PNG format.\n> @param out  the output stream (<code>null</code> not permitted).\n> @param chart  the chart (<code>null</code> not permitted).\n> @param width  the image width.\n> @param height  the image height.\n> @throws IOException if there are any I/O errors.\n> Writes a chart to an output stream in PNG format.\n> @param out  the output stream (<code>null</code> not permitted).\n> @param chart  the chart (<code>null</code> not permitted).\n> @param width  the image width.\n> @param height  the image height.\n> @param encodeAlpha  encode alpha?\n> @param compression  the compression level (0-9).\n> @throws IOException if there are any I/O errors.\n> Writes a chart to an output stream in PNG format.  This method allows\n> you to pass in a {@link ChartRenderingInfo} object, to collect\n> information about the chart dimensions/entities.  You will need this\n> info if you want to create an HTML image map.\n> @param out  the output stream (<code>null</code> not permitted).\n> @param chart  the chart (<code>null</code> not permitted).\n> @param width  the image width.\n> @param height  the image height.\n> @param info  the chart rendering info (<code>null</code> permitted).\n> @throws IOException if there are any I/O errors.\n> Writes a chart to an output stream in PNG format.  This method allows\n> you to pass in a {@link ChartRenderingInfo} object, to collect\n> information about the chart dimensions/entities.  You will need this\n> info if you want to create an HTML image map.\n> @param out  the output stream (<code>null</code> not permitted).\n> @param chart  the chart (<code>null</code> not permitted).\n> @param width  the image width.\n> @param he\n[...truncated...]\n\n\n\n---\nIMPORTANT: Your entire response must be *only* the Java code for the test method. Start your response directly with the method signature `public void test`."
  }
]